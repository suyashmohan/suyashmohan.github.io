<!DOCTYPE html><html><head><meta charset="utf-8"><title>util.promisify() in Node.js v8 | Farzi Coder</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="If you have ever worked with Javascript you must have experienced callbacks. Javascript is known for its inbuilt asynchronous philosophy. From standard inbuilt modules to other frameworks and librarie"><meta name="keywords" content="Node.js,Javascript"><meta property="og:type" content="article"><meta property="og:title" content="util.promisify() in Node.js v8"><meta property="og:url" content="http://farzicoder.com/util-promisify-in-Node-js-v8/index.html"><meta property="og:site_name" content="Farzi Coder"><meta property="og:description" content="If you have ever worked with Javascript you must have experienced callbacks. Javascript is known for its inbuilt asynchronous philosophy. From standard inbuilt modules to other frameworks and librarie"><meta property="og:locale" content="default"><meta property="og:updated_time" content="2020-01-17T05:38:44.992Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="util.promisify() in Node.js v8"><meta name="twitter:description" content="If you have ever worked with Javascript you must have experienced callbacks. Javascript is known for its inbuilt asynchronous philosophy. From standard inbuilt modules to other frameworks and librarie"><link rel="alternate" href="/atom.xml" title="Farzi Coder" type="application/atom+xml"><link rel="icon" href="/favicon.png"><link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet"><link rel="stylesheet" href="/css/style.css"><!-- Google Analytics --><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-100366340-1', 'auto');
ga('send', 'pageview');</script><!-- End Google Analytics --></head></html><body><div id="container"><div id="wrap"><header id="header"><div id="banner"></div><div id="header-outer" class="outer"><div id="header-title" class="inner"><h1 id="logo-wrap"><a href="/" id="logo">Farzi Coder</a></h1><h2 id="subtitle-wrap"><a href="/" id="subtitle">Adventures of a coder</a></h2></div><div id="header-inner" class="inner"><nav id="main-nav"><a id="main-nav-toggle" class="nav-icon"></a> <a class="main-nav-link" href="/">Home</a> <a class="main-nav-link" href="/archives">Archives</a></nav><nav id="sub-nav"><a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a> <a id="nav-search-btn" class="nav-icon" title="Search"></a></nav><div id="search-form-wrap"><form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://farzicoder.com"></form></div></div></div></header><div class="outer"><section id="main"><article id="post-util-promisify-in-Node-js-v8" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/util-promisify-in-Node-js-v8/" class="article-date"><time datetime="2017-06-06T16:33:00.000Z" itemprop="datePublished">2017-06-06</time></a><div class="article-category"><a class="article-category-link" href="/categories/Node-js/">Node.js</a></div></div><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name">util.promisify() in Node.js v8</h1></header><div class="article-entry" itemprop="articleBody"><p>If you have ever worked with Javascript you must have experienced callbacks. Javascript is known for its inbuilt asynchronous philosophy. From standard inbuilt modules to other frameworks and libraries, callbacks are everywhere. That’s how asynchronous programming is done in Javascript. But there is a dark side of Callbacks. It’s called <a href="http://callbackhell.com/" target="_blank" rel="external">Callback Hells</a>.<br><a id="more"></a><br>The solution to callback hell is <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="external">Promises</a>. Instead of returning a value synchronously or passing result through a callback, we can return a promise that we are going to return some value or error in future.<br>To use promises there are a number of good libraries like <a href="https://github.com/petkaantonov/bluebird/" target="_blank" rel="external">Bluebird</a> and <a href="https://github.com/kriskowal/q" target="_blank" rel="external">Q</a>. But inbuilt modules and lot of other libraries don’t utilize Promises. Although these libraries are able to convert traditional callback methods into promises, we have an official way to promisify callback methods in Node v8. It is <code>util.promisify</code>. According to Node.js’s <a href="https://nodejs.org/dist/latest-v8.x/docs/api/util.html#util_util_promisify_original" target="_blank" rel="external">documentation</a>:</p><p><code>util.promisify</code> <em>takes a function following the common Node.js callback style, i.e. taking a (err, value) =&gt; … callback as the last argument, and returns a version that returns promises.</em></p><p>Take a look at traditional example:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line">fs.readFile(<span class="string">'./index.js'</span>, <span class="string">'utf8'</span>, (err, text) =&gt; &#123;</div><div class="line">    <span class="keyword">if</span> (err) &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'Error'</span>, err);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(text);</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p><p>Now this example can be written with Promises as following:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"><span class="keyword">const</span> util = <span class="built_in">require</span>(<span class="string">'util'</span>);</div><div class="line"></div><div class="line"><span class="keyword">const</span> readFile = util.promisify(fs.readFile);</div><div class="line">readFile(<span class="string">'./index.js'</span>, <span class="string">'utf8'</span>)</div><div class="line">    .then(<span class="function">(<span class="params">text</span>) =&gt;</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(text);</div><div class="line">    &#125;)</div><div class="line">    .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'Error'</span>, err);</div><div class="line">    &#125;);</div></pre></td></tr></table></figure></p><p>Here we used <code>util.promisify</code> to convert fs.readFile into a promise based method. Now instead of taking a callback, the readFile method gives as a Promise. Promise has two methods, <code>then</code> and <code>catch</code>. <code>then</code> is used to get the result if the function call was successful. Whereas <code>catch</code> is used to catch the error if occurred. The advantage of Promise is that we can chain asynchronous calls without falling into callback hell.</p><h2 id="Async-amp-Await"><a href="#Async-amp-Await" class="headerlink" title="Async &amp; Await"></a>Async &amp; Await</h2><p>This is the most fun part I like. Promises can become a lot easier to deal with when combined with async &amp; await keywords. Even chaining of promises can look nasty when it gets bigger. Async &amp; Await make it look cleaner. Here is the above example with Async &amp; Await:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"><span class="keyword">const</span> util = <span class="built_in">require</span>(<span class="string">'util'</span>);</div><div class="line"></div><div class="line"><span class="keyword">const</span> readFile = util.promisify(fs.readFile);</div><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">doFile</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        <span class="keyword">const</span> text = <span class="keyword">await</span> readFile(<span class="string">'./index.js'</span>, <span class="string">'utf8'</span>);</div><div class="line">        <span class="built_in">console</span>.log(text);</div><div class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'Error'</span>, err);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">doFile();</div></pre></td></tr></table></figure></p><p>I hope you liked this post. Since I am just starting up with this blog, If you have any doubt or advice, please let me know through the comments.</p></div><footer class="article-footer"><a data-url="http://farzicoder.com/util-promisify-in-Node-js-v8/" data-id="ck5vuei32000s7vmnhv7i6lad" class="article-share-link">Share</a> <a href="http://farzicoder.com/util-promisify-in-Node-js-v8/#disqus_thread" class="article-comment-link">Comments</a><ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javascript/">Javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node-js/">Node.js</a></li></ul></footer></div><nav id="article-nav"><a href="/Callback-Hell-Promises-generators-Async-Await-in-Node-js-Javascript/" id="article-nav-newer" class="article-nav-link-wrap"><strong class="article-nav-caption">Newer</strong><div class="article-nav-title">Callback Hell, Promises, Generators &amp; Async-Await in Node.js/Javascript</div></a> <a href="/Hello-World-in-Node-js-Part-3-Express-Js/" id="article-nav-older" class="article-nav-link-wrap"><strong class="article-nav-caption">Older</strong><div class="article-nav-title">Hello World in Node.js - Part 3 - Express.Js</div></a></nav></article><section id="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></section></section><aside id="sidebar"><div class="widget-wrap"><h3 class="widget-title">Categories</h3><div class="widget"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Blockchain/">Blockchain</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kubernetes/">Kubernetes</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/">Node.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Thoughts/">Thoughts</a></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">Tags</h3><div class="widget"><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Blockchain/">Blockchain</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Containers/">Containers</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Database/">Database</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ethereum/">Ethereum</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Express-js/">Express.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Javascript/">Javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kubernetes/">Kubernetes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NPM/">NPM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node-js/">Node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Postgresql/">Postgresql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Smart-Contracts/">Smart Contracts</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Thoughts/">Thoughts</a></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">Tag Cloud</h3><div class="widget tagcloud"><a href="/tags/Blockchain/" style="font-size: 16.67px">Blockchain</a> <a href="/tags/Containers/" style="font-size: 13.33px">Containers</a> <a href="/tags/Database/" style="font-size: 10px">Database</a> <a href="/tags/Ethereum/" style="font-size: 16.67px">Ethereum</a> <a href="/tags/Express-js/" style="font-size: 10px">Express.js</a> <a href="/tags/Javascript/" style="font-size: 20px">Javascript</a> <a href="/tags/Kubernetes/" style="font-size: 13.33px">Kubernetes</a> <a href="/tags/NPM/" style="font-size: 10px">NPM</a> <a href="/tags/Node-js/" style="font-size: 20px">Node.js</a> <a href="/tags/Postgresql/" style="font-size: 10px">Postgresql</a> <a href="/tags/Smart-Contracts/" style="font-size: 16.67px">Smart Contracts</a> <a href="/tags/Thoughts/" style="font-size: 10px">Thoughts</a></div></div><div class="widget-wrap"><h3 class="widget-title">Archives</h3><div class="widget"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">Recent Posts</h3><div class="widget"><ul><li><a href="/Setup-Databases-like-PostgreSQL-inside-Kubernetes-cluster/">Setup Databases like PostgreSQL inside Kubernetes cluster</a></li><li><a href="/Nginx-Ingress-setup-for-kubernetes/">Nginx Ingress setup for kubernetes</a></li><li><a href="/Writing-your-First-Smart-Contract-using-Solidity-Part-2-Getting-Started-with-Smart-Contracts-Blockchain/">Writing your first Smart Contract using Solidity - Part 2 - Getting Started with Smart Contracts &amp; Blockchain</a></li><li><a href="/Setting-up-Geth-Mist-TestRPC-Part-1-Getting-Start-with-Smart-Contracts/">Setting up Geth, Mist &amp; TestRPC - Part 1 - Getting Started with Smart Contracts &amp; Blockchain</a></li><li><a href="/Getting-Started-with-Smart-Contracts-Blockchain-Part-0-Understanding-Basics/">Getting Started with Smart Contracts &amp; Blockchain - Part 0 Understanding Basics</a></li></ul></div></div></aside></div><footer id="footer"><div class="outer"><div id="footer-info" class="inner">&copy; 2020 Suyash Mohan<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></div></div></footer></div><nav id="mobile-nav"><a href="/" class="mobile-nav-link">Home</a> <a href="/archives" class="mobile-nav-link">Archives</a></nav><script>var disqus_shortname = 'farzi-coder';
  
  var disqus_url = 'http://farzicoder.com/util-promisify-in-Node-js-v8/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();</script><script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script><link rel="stylesheet" href="/fancybox/jquery.fancybox.css"><script src="/fancybox/jquery.fancybox.pack.js"></script><script src="/js/script.js"></script></div></body>